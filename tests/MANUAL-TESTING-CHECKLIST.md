# Manual Testing Checklist - Chrome Extension

このチェックリストは、Chrome Extension版のSlack Search Result Exporterの手動テストを実施するためのものです。

## テスト環境のセットアップ

### 1. 拡張機能のビルド

```bash
npm run build
```

### 2. Chrome拡張機能のロード

1. Chrome を開く
2. `chrome://extensions/` に移動
3. 右上の「デベロッパーモード」をオンにする
4. 「パッケージ化されていない拡張機能を読み込む」をクリック
5. プロジェクトの `dist/` フォルダを選択

## Task 6.2: 既存機能の検証

### 6.2.1 基本的なエクスポート機能

- [ ] Slackの検索結果ページに移動
- [ ] 拡張機能アイコンをクリック
- [ ] ポップアップが開くことを確認
- [ ] 「エクスポート」ボタンをクリック
- [ ] 進行状況インジケータが表示されることを確認
- [ ] TSV結果がテキストエリアに表示されることを確認
- [ ] メッセージ件数が正しいことを確認

**期待される結果**:
- ポップアップUIが正しく表示される
- エクスポート中に「エクスポート中...」が表示される
- 結果セクションにTSVデータが表示される
- メッセージ数が表示される

### 6.2.2 ページネーション

- [ ] 複数ページにわたる検索結果を作成（例: `in:#general` で100件以上）
- [ ] エクスポートを実行
- [ ] 進行状況が更新されることを確認（「1ページ目... 2ページ目...」など）
- [ ] 全ページのメッセージが収集されることを確認

**期待される結果**:
- 複数ページが自動的に処理される
- 全てのメッセージが重複なく収集される

### 6.2.3 TSV形式の検証

- [ ] エクスポート結果を確認
- [ ] 各行が4列（タイムスタンプ、チャンネル、送信者、本文）で構成されることを確認
- [ ] タブ文字が正しく処理されることを確認
- [ ] 改行が `<br>` に変換されることを確認

**期待される結果**:
```
2025-12-20 Fri 10:30:00	#general	user1	メッセージ本文
2025-12-20 Fri 10:31:00	#general	user2	複数行<br>メッセージ
```

### 6.2.4 リンクのMarkdown変換

- [ ] 外部リンクを含むメッセージを検索
- [ ] エクスポートを実行
- [ ] リンクが `[テキスト](URL)` 形式に変換されることを確認

**期待される結果**:
```
HTMLの <a href="https://example.com">リンク</a> が [リンク](https://example.com) に変換される
```

### 6.2.5 セキュリティフィルタリング

- [ ] `javascript:` プロトコルのリンクが除外されることを確認
- [ ] `http://` と `https://` のリンクのみが変換されることを確認

## Task 6.3: Chrome Extension固有機能の検証

### 6.3.1 日付プリセット選択

- [ ] ポップアップを開く
- [ ] 「当日」ボタンをクリック
- [ ] ボタンがアクティブ状態（ハイライト）になることを確認
- [ ] 「昨日」ボタンをクリック
- [ ] 「昨日」がアクティブになり、「当日」が非アクティブになることを確認
- [ ] 同様に「一週間」と「一ヶ月」をテスト

**期待される結果**:
- 選択されたプリセットボタンがハイライトされる
- 一度に1つのプリセットのみがアクティブになる

### 6.3.2 設定の永続化

- [ ] 日付プリセットを選択（例: 「今日」）
- [ ] ポップアップを閉じる
- [ ] 拡張機能アイコンを再度クリック
- [ ] 前回選択したプリセットがアクティブになっていることを確認

**期待される結果**:
- 選択したプリセットが保存される
- 次回起動時に同じプリセットが選択された状態で表示される

### 6.3.3 デフォルト設定の確認

- [ ] Chrome DevTools を開く
- [ ] Application → Storage → Chrome Storage → Extension を開く
- [ ] ストレージをクリア
- [ ] ポップアップを開く
- [ ] 「一週間」がデフォルトで選択されていることを確認

**期待される結果**:
- ストレージが空の場合、「一週間」がデフォルト設定として選択される

### 6.3.4 クリップボードコピー

- [ ] エクスポートを実行して結果を取得
- [ ] 「クリップボードにコピー」ボタンをクリック
- [ ] テキストエディタに貼り付け
- [ ] TSVデータが正しくコピーされていることを確認

**期待される結果**:
- ワンクリックでTSVデータがクリップボードにコピーされる
- 貼り付けたデータがテキストエリアの内容と一致する

### 6.3.5 チャンネルページエクスポート

- [ ] Slackチャンネルページに移動（検索結果ではなく、通常のチャンネル表示）
- [ ] 拡張機能アイコンをクリック
- [ ] 「エクスポート」を実行
- [ ] チャンネルメッセージがエクスポートされることを確認

**期待される結果**:
- チャンネルページでもエクスポートが機能する
- 表示されているメッセージが収集される

### 6.3.6 エラーハンドリング - 非Slackページ

- [ ] Google.com などの非Slackページに移動
- [ ] 拡張機能アイコンをクリック
- [ ] 「エクスポート」を実行
- [ ] エラーメッセージが表示されることを確認

**期待される結果**:
- 「Slackページでのみ使用可能です」または同等のエラーメッセージが表示される
- エクスポートは実行されない

### 6.3.7 日付プリセットの適用

- [ ] Slack検索ページに移動
- [ ] ポップアップを開く
- [ ] 「当日」プリセットを選択
- [ ] エクスポートを実行
- [ ] 本日の日付でフィルタされた結果が返ることを期待

**注**: この機能は検索クエリの自動適用を含むため、Slackの検索UIとの統合が必要です。

## Task 6.4: パフォーマンステスト（オプション）

### 6.4.1 大量メッセージのエクスポート

- [ ] 100件以上のメッセージを含む検索を実行
- [ ] エクスポートを実行
- [ ] ブラウザがフリーズしないことを確認
- [ ] エクスポート完了までの時間を記録

**期待される結果**:
- エクスポート中もブラウザは応答性を維持
- 進行状況が適切に表示される
- 100件のメッセージが10秒以内にエクスポートされる

### 6.4.2 ページネーション性能

- [ ] 10ページ以上にわたる検索結果を作成
- [ ] エクスポート時間を測定
- [ ] メモリ使用量を確認（Chrome Task Manager）

**期待される結果**:
- 10ページのエクスポートが30秒以内に完了
- メモリリークがない

### 6.4.3 Storage書き込み頻度

- [ ] DevToolsのNetworkタブを開く
- [ ] 日付プリセットを複数回変更
- [ ] Storage APIの呼び出し頻度を確認

**期待される結果**:
- 過剰なStorage書き込みがない
- 1分間に120回以下のStorage操作（Chrome制限内）

### 6.4.4 Content Script起動時間

- [ ] DevToolsのPerformanceタブを開く
- [ ] Slackページを読み込み
- [ ] Content Scriptの初期化時間を確認

**期待される結果**:
- Content Script起動がページ読み込みを遅延させない
- 200ms以下で初期化完了

## テスト結果の記録

### テスト実行日時
- 日付: _______________
- テスター: _______________

### 環境情報
- OS: _______________
- Chrome バージョン: _______________
- 拡張機能バージョン: 1.0.0

### Task 6.2 結果
- [ ] 全てのテストケースが合格
- [ ] 一部失敗（詳細: _______________）
- [ ] 未実施

### Task 6.3 結果
- [ ] 全てのテストケースが合格
- [ ] 一部失敗（詳細: _______________）
- [ ] 未実施

### Task 6.4 結果（オプション）
- [ ] 全てのテストケースが合格
- [ ] 一部失敗（詳細: _______________）
- [ ] 未実施

### 発見された問題
1. _______________
2. _______________
3. _______________

### 備考
_______________
_______________
_______________

## 自動化への移行

このチェックリストの項目は、将来的にPlaywright E2Eテストとして自動化できます。
詳細は `tests/integration/E2E-TESTING-GUIDE.md` を参照してください。

## 参考資料

- 統合テスト: `tests/integration/component-integration.test.ts`
- E2Eテストガイド: `tests/integration/E2E-TESTING-GUIDE.md`
- セキュリティテスト: `tests/e2e/security-validation.spec.js`
- ブラウザ互換性テスト: `tests/e2e/browser-compatibility.spec.js`
